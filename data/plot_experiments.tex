\documentclass[border=5pt]{standalone}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\usepgfplotslibrary{fillbetween}

\begin{document}

% Plot for 3-4.TRD
\begin{tikzpicture}
\begin{axis}[
    width=16cm,
    height=8cm,
    xlabel={Time (seconds)},
    ylabel={Value},
    title={3-4.TRD - Lesson 3: 5 Experiments (1 Failed)},
    grid=both,
    grid style={gray!30},
    ymin=-200,
    ymax=550,
    xmin=0,
    xmax=2300,
    legend pos=south east,
    legend style={font=\small},
]

% Setpoint line
\addplot[red, dashed, thick] coordinates {(0,450) (2300,450)};
\addlegendentry{Setpoint (SP=450)}

% Zero line
\addplot[gray, thin] coordinates {(0,0) (2300,0)};

% Process variable
\addplot[blue, thick, each nth point=5] table[x=time, y=pv, col sep=comma] {3-4.csv};
\addlegendentry{Process Variable (PV)}

% Experiment boundary annotations
\node[above, green!50!black, font=\scriptsize] at (axis cs:200,520) {Exp 1};

\draw[red!70!black, thick, dashed] (axis cs:466,550) -- (axis cs:466,-200);
\node[above, red!70!black, font=\scriptsize] at (axis cs:530,520) {Exp 2};
\node[below, red!70!black, font=\tiny] at (axis cs:530,500) {(FAILED)};

\draw[green!50!black, thick, dashed] (axis cs:607,550) -- (axis cs:607,-200);
\node[above, green!50!black, font=\scriptsize] at (axis cs:900,520) {Exp 3};

\draw[green!50!black, thick, dashed] (axis cs:1200,550) -- (axis cs:1200,-200);
\node[above, green!50!black, font=\scriptsize] at (axis cs:1550,520) {Exp 4};

\draw[green!50!black, thick, dashed] (axis cs:1920,550) -- (axis cs:1920,-200);
\node[above, green!50!black, font=\scriptsize] at (axis cs:2100,520) {Exp 5};

\end{axis}
\end{tikzpicture}

\vspace{1cm}

% Plot for 4-7.TRD
\begin{tikzpicture}
\begin{axis}[
    width=16cm,
    height=8cm,
    xlabel={Time (seconds)},
    ylabel={Value},
    title={4-7.TRD - Lesson 4: 7 Experiments (Step Response Tests)},
    grid=both,
    grid style={gray!30},
    ymin=-100,
    ymax=550,
    xmin=0,
    xmax=2600,
    legend pos=south east,
    legend style={font=\small},
]

% Setpoint line
\addplot[red, dashed, thick] coordinates {(0,450) (2600,450)};
\addlegendentry{Setpoint (SP=450)}

% Zero line
\addplot[gray, thin] coordinates {(0,0) (2600,0)};

% Process variable
\addplot[blue, thick, each nth point=5] table[x=time, y=pv, col sep=comma] {4-7.csv};
\addlegendentry{Process Variable (PV)}

% Experiment boundary annotations (at local minima)
\draw[green!50!black, thick, dashed] (axis cs:46,550) -- (axis cs:46,-100);
\node[above, green!50!black, font=\scriptsize] at (axis cs:46,520) {2};

\draw[green!50!black, thick, dashed] (axis cs:534,550) -- (axis cs:534,-100);
\node[above, green!50!black, font=\scriptsize] at (axis cs:534,520) {3};

\draw[green!50!black, thick, dashed] (axis cs:928,550) -- (axis cs:928,-100);
\node[above, green!50!black, font=\scriptsize] at (axis cs:928,520) {4};

\draw[green!50!black, thick, dashed] (axis cs:1422,550) -- (axis cs:1422,-100);
\node[above, green!50!black, font=\scriptsize] at (axis cs:1422,520) {5};

\draw[green!50!black, thick, dashed] (axis cs:1856,550) -- (axis cs:1856,-100);
\node[above, green!50!black, font=\scriptsize] at (axis cs:1856,520) {6};

\draw[green!50!black, thick, dashed] (axis cs:2221,550) -- (axis cs:2221,-100);
\node[above, green!50!black, font=\scriptsize] at (axis cs:2221,520) {7};

\node[above, green!50!black, font=\scriptsize] at (axis cs:20,520) {1};

\end{axis}
\end{tikzpicture}

\end{document}
