% ============================================================
% Preamble - Vietnamese Academic Document Settings
% BTL CSDK - Process Control Lab Report
% ============================================================

\documentclass[13pt, a4paper]{article}

% ============================================================
% FONTS & LANGUAGE
% ============================================================
\usepackage{fontspec}
% FreeSerif is a Times-like font with full Vietnamese Unicode support
\setmainfont{FreeSerif}
\usepackage[vietnamese]{babel}

% ============================================================
% PAGE LAYOUT
% ============================================================
\usepackage[
    a4paper,
    left=3cm,
    right=2cm,
    top=2.5cm,
    bottom=2.5cm
]{geometry}

% Line spacing
\usepackage{setspace}
\onehalfspacing

% Paragraph indentation
\usepackage{indentfirst}
\setlength{\parindent}{1cm}

% ============================================================
% HEADERS & FOOTERS
% ============================================================
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0pt}

% ============================================================
% HEADINGS
% ============================================================
\usepackage{titlesec}

% Section (Lab title) - 14pt bold
\titleformat{\section}
    {\normalfont\fontsize{14}{16}\bfseries}
    {\thesection.}{0.5em}{}
\titlespacing*{\section}{0pt}{24pt}{12pt}

% Subsection - 13pt bold
\titleformat{\subsection}
    {\normalfont\fontsize{13}{15}\bfseries}
    {\thesubsection.}{0.5em}{}
\titlespacing*{\subsection}{0pt}{18pt}{6pt}

% Subsubsection - 13pt bold
\titleformat{\subsubsection}
    {\normalfont\fontsize{13}{15}\bfseries}
    {\thesubsubsection.}{0.5em}{}
\titlespacing*{\subsubsection}{0pt}{12pt}{6pt}

% ============================================================
% TABLE OF CONTENTS
% ============================================================
\usepackage{tocloft}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\contentsname}{MỤC LỤC}

% ============================================================
% LISTS
% ============================================================
\usepackage{enumitem}
\setlist[itemize]{leftmargin=1.5cm, itemsep=2pt}
\setlist[enumerate]{leftmargin=1.5cm, itemsep=2pt}

% ============================================================
% TABLES
% ============================================================
\usepackage{booktabs}
\usepackage{array}
\usepackage{tabularx}
\usepackage{multirow}

% ============================================================
% FIGURES & GRAPHICS
% ============================================================
\usepackage{graphicx}
\usepackage{float}
\usepackage{caption}
\captionsetup{
    font=small,
    labelfont=bf,
    justification=centering
}

% ============================================================
% CODE LISTINGS
% ============================================================
\usepackage{listings}
\usepackage{xcolor}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{arduino}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{blue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    frame=single,
    language=C++
}

\lstset{style=arduino}

% ============================================================
% HYPERLINKS
% ============================================================
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=black,
    urlcolor=blue,
    citecolor=black
}

% ============================================================
% MATH
% ============================================================
\usepackage{amsmath}
\usepackage{amssymb}

% ============================================================
% CUSTOM COMMANDS
% ============================================================
% Bold paragraph header
\newcommand{\boldpara}[1]{\noindent\textbf{#1}\par}

% Lab section with custom numbering
\newcommand{\labsection}[1]{\section*{#1}\addcontentsline{toc}{section}{#1}}
